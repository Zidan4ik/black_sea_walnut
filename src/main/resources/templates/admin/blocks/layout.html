<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout=""
      lang="uk"
      dir="ltr"
      data-theme="theme-default"
      data-assets-path="/static/">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <link rel="stylesheet" th:href="@{/vuexy/assets/vendor/css/rtl/core.css}"/>
    <link rel="stylesheet" th:href="@{/vuexy/assets/vendor/css/rtl/theme-default.css}"/>
    <link rel="stylesheet" th:href="@{/vuexy/assets/vendor/fonts/tabler-icons.css}">
    <link th:href="@{/froala_editor/css/froala_style.min.css}" rel="stylesheet" type="text/css"/>
    <link th:href="@{/froala_editor/css/froala_editor.pkgd.min.css}" rel="stylesheet" type="text/css"/>
    <link th:href="@{/froala_editor/css/themes/dark.min.css}" rel="stylesheet" type="text/css"/>
    <link rel="stylesheet" th:href="@{/vuexy/assets/vendor/libs/bootstrap-datepicker/bootstrap-datepicker.css}"/>
    <link rel="stylesheet" th:href="@{/vuexy/assets/vendor/libs/spinkit/spinkit.css}"/>
    <link rel="stylesheet" th:href="@{/vuexy/assets/vendor/libs/animate-css/animate.css}"/>
    <link rel="stylesheet" th:href="@{/vuexy/assets/vendor/libs/sweetalert2/sweetalert2.css}"/>
    <link rel="stylesheet" class="template-customizer-core-css" th:href="@{/vuexy/assets/vendor/css/core.css}"/>
    <link rel="stylesheet" class="template-customizer-theme-css"
          th:href="@{/vuexy/assets/vendor/css/theme-default.css}"/>
    <link rel="stylesheet" th:href="@{/vuexy/assets/css/demo.css}"/>

    <script th:src="@{/vuexy/assets/vendor/libs/sweetalert2/sweetalert2.js}"></script>
    <script type="text/javascript" th:src="@{/froala_editor/js/froala_editor.pkgd.min.js}"></script>
    <script th:src="@{/jquery/jquery-3.7.1.min.js}"></script>
    <script th:src="@{/htmx/htmx.min.js}"></script>

    <script th:src="@{/vuexy/assets/vendor/js/helpers.js}"></script>
    <script th:src="@{/vuexy/assets/vendor/js/template-customizer.js}"></script>

    <script th:inline="javascript">
        let contextPath = '[[@{/}]]'.replaceAll("\"", "");
        if (contextPath !== "/" && contextPath.endsWith("/")) {
            contextPath = contextPath.slice(0, -1);
        }
    </script>

    <style>
        #template-customizer,
        .template-customizer-open,
        .template-customizer-core {
            display: none !important;
            visibility: hidden !important;
        }

        .pointer {
            cursor: pointer;
        }
    </style>

    <link rel="stylesheet" th:href="@{/css/pagination.css}"/>
    <link rel="stylesheet" th:href="@{/css/table.css}"/>
    <link rel="stylesheet" th:href="@{/css/icon.css}"/>
    <link rel="stylesheet" th:href="@{/css/button.css}"/>
    <link rel="stylesheet" th:href="@{/css/text.css}"/>
    <link rel="stylesheet" th:href="@{/css/tabs-localization.css}"/>
    <link rel="stylesheet" th:href="@{/css/admin/sidebar.css}"/>
    <link rel="stylesheet" th:href="@{/css/admin/basic.css}"/>
    <link rel="stylesheet" th:href="@{/css/admin/validation.css}"/>
</head>

<body>
<!-- Layout wrapper -->
<div class="layout-wrapper layout-content-navbar">

    <!-- Layout container -->
    <div class="layout-container">
        <!-- Menu -->
        <th:block th:insert="~{admin/blocks/sidebar::sidebar}"></th:block>
        <!--/ Menu -->
        <!-- Layout page -->
        <div class="layout-page">
            <!-- Navbar -->
            <th:block th:insert="~{admin/blocks/navbar::navbar}"></th:block>
            <!--/ Navbar -->
            <!-- Content wrapper -->
            <div class="content-wrapper justify-content-center">
                <!-- Content -->
                <div layout:fragment="content">

                </div>
                <!--/ Content -->
                <!-- Content area backdrop -->
                <div class="content-backdrop fade"></div>
            </div>
            <!--/ Content wrapper -->
        </div>
        <!--/ Layout page -->
    </div>
    <!--/ Layout container -->
    <!-- Overlay -->
    <div class="layout-overlay layout-menu-toggle"></div>
    <!-- Drag Target Area To SlideIn Menu On Small Screens -->
    <div class="drag-target"></div>
</div>
<!--/ Layout wrapper -->

<div layout:fragment="modal-content"></div>

<div class="modal fade show" id=" " tabindex="-1" aria-modal="true" role="dialog">
    <div class="modal-dialog modal-dialog-centered modal-md" role="document">
        <div class="modal-content">
            <div class="modal-header text-center" style="font-size: 20px" th:text="#{text.areYouSureToExit}"></div>
            <div class="modal-footer">
                <a th:href="@{/logout}" class="btn btn-danger float-end" th:text="#{text.logout}"></a>
                <button class="btn btn-secondary float-end" data-bs-dismiss="modal"
                        th:text="#{value.status.cancel}"></button>
            </div>
        </div>
    </div>
</div>

<!-- Modal -->
<div layout:fragment="modal-content" class="modal fade" id="ModalForDelete" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Are you sure to delete it?</h5>
            </div>
            <div class="modal-footer justify-content-end">
                <a type="button" id="modal-btnDelete_" class="btn btn-danger">
                    Delete
                </a>
                <button type="button" class="btn btn-label-secondary" data-bs-dismiss="modal">
                    Cancel
                </button>
            </div>
        </div>
    </div>
    <script th:src="@{/vuexy/assets/vendor/libs/bootstrap-datepicker/bootstrap-datepicker.js}"></script>
</div>
<!--/ Modal -->

<script th:src="@{/vuexy/assets/vendor/libs/bootstrap-datepicker/bootstrap-datepicker.js}"></script>
<script>
    function focusInput(element) {
        const $input = $(element).closest('.input-group').find('input');
        if ($input.length > 0) {
            $input.focus();
        }
    }
</script>
<script th:src="@{/vuexy/assets/vendor/js/helpers.js}"></script>
<script th:src="@{/vuexy/assets/js/config.js}"></script>
<script th:src="@{/vuexy/dist/js/bootstrap.js}"></script>
<script th:src="@{/vuexy/assets/vendor/js/menu.js}"></script>
<script th:src="@{/vuexy/assets/js/main.js}"></script>
<script th:src="@{/vuexy/assets/vendor/libs/block-ui/block-ui.js}"></script>
<script th:src="@{/js/messageLocal.js}"></script>

<script>
    let current_mode;
    $(document).ready(function () {
        $('#btn-logout').on('click', invokeLogoutModal);
    });

    function syncThemeIcon() {
        const themeIcon = document.getElementById('theme-icon');
        if (!themeIcon) return;

        let skin = 'light';

        if (window.templateCustomizer && typeof window.templateCustomizer.getThemeSkin === 'function') {
            skin = window.templateCustomizer.getThemeSkin();
        } else {
            skin = document.documentElement.classList.contains('dark-style') ? 'dark' : 'light';
            current_mode = skin;
        }

        if (skin === 'dark') {
            themeIcon.classList.remove('ti-sun');
            themeIcon.classList.add('ti-moon');
        } else {
            themeIcon.classList.remove('ti-moon');
            themeIcon.classList.add('ti-sun');
        }
    }

    syncThemeIcon();

    document.addEventListener('DOMContentLoaded', function () {
        const themeToggler = document.getElementById('theme-toggler');

        syncThemeIcon();

        if (themeToggler) {
            themeToggler.addEventListener('click', function () {
                const customizer = window.templateCustomizer;
                const currentSkin = document.documentElement.classList.contains('dark-style') ? 'dark' : 'light';
                const newSkin = (currentSkin === 'dark') ? 'light' : 'dark';

                if (customizer) {
                    customizer.setStyle(newSkin);
                }

                setTimeout(syncThemeIcon, 10);
            });
        }

        const configEl = document.getElementById('template-customizer');
        if (configEl) configEl.remove();
    });

    function invokeLogoutModal() {
        Swal.fire({
            title: `<div style="width: 100%; margin-top: -35px;"> ${messages.warning + '!'} </div>`,
            icon: 'warning',
            text: messages.youSureLogout + '?',
            confirmButtonText: messages.exit,
            cancelButtonText: messages.cancel,
            customClass: {
                confirmButton: 'btn btn-danger me-3',
                cancelButton: 'btn btn-label-secondary'
            },
            buttonsStyling: false
        }).then((result) => {
            if (result.isConfirmed) {
                window.location.href = `${contextPath}/logout`
            }
        });
    }

    function invokeBlockUI() {
        $("#card-block").block({
            message: '<div class="sk-wave sk-primary mx-auto"><div class="sk-rect sk-wave-rect"></div> <div class="sk-rect sk-wave-rect"></div> <div class="sk-rect sk-wave-rect"></div> <div class="sk-rect sk-wave-rect"></div> <div class="sk-rect sk-wave-rect"></div></div>',
            css: {
                backgroundColor: "transparent",
                border: "0"
            },
            overlayCSS: {
                backgroundColor: "#fff",
                opacity: 0.8
            }
        });
    }

    function setCookie(name, value, days) {
        let expires = "";
        if (days) {
            let date = new Date();
            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
            expires = "; expires=" + date.toUTCString();
        }
        document.cookie = name + "=" + value + "; path=/" + expires + "; SameSite=Lax";
    }

    function getCookie(name) {
        let match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
        return match ? match[2] : null;
    }

    function selectedLanguage() {
        $(".button-dropdown").on("click", function () {
            let lang = $(this).attr("data-lang");
            if (lang) {
                setCookie("lang", lang, 30);
                window.location.reload();
            }
        });

        window.addEventListener("load", function () {
            let lang = getCookie("lang");
            if (lang) {
                document.documentElement.lang = lang;
                let $languageCode = $("#languageCode_");
                if ($languageCode) {
                    $languageCode.val(lang);
                }
            }
        });
    }

    function getCurrentLang() {
        return document.documentElement.lang;
    }

    function returnUserStatus(status) {
        let currentLang = getCurrentLang();
        if (status === 'legal') {
            if (currentLang === 'uk') {
                return 'Юридичне обличчя';
            } else if (currentLang === 'en') {
                return 'Legal';
            }
        } else if (status === 'fop') {
            if (currentLang === 'uk') {
                return 'Адреса Фоп';
            } else if (currentLang === 'en') {
                return 'Address Fop';
            }
        } else if (status === 'individual') {
            if (currentLang === 'uk') {
                return 'Фізичне обличчя';
            } else if (currentLang === 'en') {
                return 'Individual';
            }
        }
    }

    function confirmAndPathDelete(ids, path, cb) {
        const messageText = messages.modalDelete;
        Swal.fire({
            title: `<div style="width: 100%; margin-top: -35px; margin-left: 15px;"> ${messages.areYouSure + '?'} </div>`,
            text: messageText + '...',
            icon: 'warning',
            showCancelButton: true,
            focusConfirm: false,
            confirmButtonText: messages.yesDeleteId + '!',
            cancelButtonText: messages.cancel,
            customClass: {
                confirmButton: 'btn me-3 btn-danger',
                cancelButton: current_mode ? 'btn btn-label-dark' : 'btn btn-label-secondary',
                popup: current_mode ? 'swal-dark-popup' : ''
            },
            buttonsStyling: false,
        }).then(function (result) {
            if (result.isConfirmed) {
                requestDeleteObjects(ids, path, cb);
            }
        });
    }

    function requestDeleteObjects(ids, path, cb) {
        let request = new XMLHttpRequest();
        request.open('DELETE', path);
        request.setRequestHeader('Content-Type', 'application/json');
        request.addEventListener('load', function () {
            if (request.status === 200) {
                Swal.fire({
                    icon: 'success',
                    title: `<div style="width: 100%; margin-top: -35px; margin-left: 15px;"> ${messages.deleted + '!'} </div>`,
                    text: messages.successDeleted + '.',
                    customClass: {
                        confirmButton: 'btn btn-success'
                    }
                }).then(() => {
                    if (cb) cb();
                });
            } else {
                let errorMessage;
                if (request.responseText) {
                    errorMessage = request.responseText;
                }
                Swal.fire({
                    icon: 'error',
                    title: `<div style="width: 100%; margin-top: -35px; margin-left: 15px;"> ${messages.error + '!'} </div>`,
                    text: errorMessage,
                    customClass: {
                        confirmButton: 'btn btn-primary'
                    }
                });
            }
        });
        request.send(JSON.stringify(ids));
    }


</script>
<script th:inline="javascript">
    const messages = {
        invalidNumberId: /*[[#{error.field.invalid.number.id}]]*/ 'default',
        invalidNumber: /*[[#{error.field.invalid.number}]]*/ 'default',
        filterProduct: /*[[#{error.filter.product}]]*/ 'default',
        filterAmount: /*[[#{error.filter.totalAmount}]]*/ 'default',
        filterPrice: /*[[#{error.filter.totalPrice}]]*/ 'default',
        filterDate: /*[[#{error.filter.date}]]*/ 'default',
        filterPhone: /*[[#{error.filter.phone}]]*/ 'default',
        lengthPhone: /*[[#{error.phone.length}]]*/ 'default',
        areYouSureToDeleteIt: /*[[#{text.areYouSure}]]*/ 'default',
        noCallAnyoneCalls: /*[[#{text.noCallAnyoneCalls}]]*/ 'default',
        warning: /*[[#{text.warning}]]*/ 'default',
        areYouSure: /*[[#{text.areYouSure2}]]*/ 'default',
        youSureLogout: /*[[#{text.areYouSure.logout}]]*/ 'default',
        exit: /*[[#{value.status.exit}]]*/ 'default',
        yesDeleteId: /*[[#{text.yesDeleteId}]]*/ 'default',
        deleted: /*[[#{value.status.deleted}]]*/ 'default',
        successDeleted: /*[[#{text.successDeleted}]]*/ 'default',
        modalDelete: /*[[#{text.modal.delete}]]*/ 'default',
        cancel: /*[[#{value.status.cancel}]]*/ 'default',
        error: /*[[#{text.error}]]*/ 'default',
        dataTableNoExist: /*[[#{text.table.exist}]]*/ 'default'
    };
</script>
</body>
</html>